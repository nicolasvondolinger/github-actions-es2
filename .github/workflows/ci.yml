# Nome do Workflow
name: Python CI Tests

# Gatilhos: executa em push ou pull request para as branches main/master
on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  # Job único para construir e testar
  build-and-test:
    # Nome do job, dinâmâmico baseado na matriz
    name: Test on ${{ matrix.os }} (Python ${{ matrix.python-version }})
    
    # Sistema operacional para rodar, vindo da matriz
    runs-on: ${{ matrix.os }}
    
    strategy:
      # Não cancela outros jobs na matriz se um falhar
      fail-fast: false
      
      # Matriz de configuração para OS e versão do Python
      matrix:
        # Requisito 3: Ubuntu, MacOS e Windows
        os: [ubuntu-latest, macos-latest, windows-latest]
        
        # Requisito 4: Pelo menos duas versões da linguagem
        python-version: ['3.9', '3.11']

    steps:
      # 1. Baixa o código do repositório
      - name: Check out code
        uses: actions/checkout@v4

      # 2. Configura a versão correta do Python
      - name: Set up Python ${{ matrix.python-version }}
        uses: actions/setup-python@v5
        with:
          python-version: ${{ matrix.python-version }}
          # A linha 'cache: 'pip'' foi removida para corrigir o erro,
          # já que não temos um requirements.txt ou pyproject.toml.

      # 3. Instala dependências (se houver)
      # Nosso projeto atual não tem dependências externas, mas é uma boa prática
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          # Se você tivesse um arquivo requirements.txt, você o instalaria aqui:
          # pip install -r requirements.txt

      # 4. Executa os testes de unidade
      # O comando 'python -m unittest' descobre e roda os testes (test_graph.py)
      - name: Run tests
        run: python -m unittest discover
        # Alternativamente, você pode rodar o arquivo diretamente:
        # run: python test_graph.py